<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <title>Créer un appel à candidature</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://cdn.quilljs.com/1.3.6/quill.snow.css"
      rel="stylesheet"
    />
  </head>
  <body class="bg-gray-50 p-8 text-gray-800">
    <div class="max-w-3xl mx-auto bg-white shadow-md rounded p-6">
      <h2 class="text-2xl font-bold text-green-700 mb-6">
        ➕ Ajouter un appel à candidature
      </h2>

      <!-- Formulaire -->
      <form method="POST">
        <!-- Titre -->
        <div class="mb-4">
          <label for="titre" class="block font-semibold mb-1"
            >Nom de l’appel</label
          >
          <input
            type="text"
            name="titre"
            id="titre"
            class="w-full border rounded px-4 py-2"
            placeholder="Ex: Data Analyst"
            required
          />
        </div>

        <!-- Date de début -->
        <div class="mb-4">
          <label for="date_debut" class="block font-semibold mb-1"
            >Date de début</label
          >
          <input
            type="date"
            name="date_debut"
            id="date_debut"
            class="w-full border rounded px-4 py-2"
            required
          />
        </div>

        <!-- Date de fin -->
        <div class="mb-4">
          <label for="date_fin" class="block font-semibold mb-1"
            >Date de fin</label
          >
          <input
            type="date"
            name="date_fin"
            id="date_fin"
            class="w-full border rounded px-4 py-2"
            required
          />
        </div>

        <!-- Description avec Quill -->
        <div class="mb-4">
          <label class="block font-semibold mb-1">Description</label>
          <div id="editor" class="bg-white h-40 border rounded"></div>
          <input type="hidden" name="description" id="description" />
        </div>

        <!-- Critères -->
        <div class="mb-6">
          <label for="criteres" class="block font-semibold mb-1">
            Critères attendus (séparés par des virgules)
          </label>
          <input
            type="text"
            name="criteres"
            id="criteres"
            class="w-full border rounded px-4 py-2"
            placeholder="Ex: Python, Power BI, SQL"
            required
          />
        </div>

        <!-- Bouton de soumission -->
        <button
          type="submit"
          class="bg-green-600 text-white font-semibold px-6 py-2 rounded hover:bg-green-700"
        >
          GÉNÉRER LE LIEN DU FORMULAIRE
        </button>
      </form>

      <!-- Retour -->
      <p class="mt-4">
        <a
          href="{{ url_for('appel.appel_home') }}"
          class="text-blue-600 underline"
        >
          ⬅ Retour au tableau de bord
        </a>
      </p>

      <!-- Messages Flash -->
      {% with messages = get_flashed_messages(with_categories=true) %} {% if
      messages %}
      <ul class="mt-4">
        {% for category, message in messages %}
        <li class="text-green-700 font-semibold">{{ message }}</li>
        {% endfor %}
      </ul>
      {% endif %} {% endwith %}
    </div>

    <!-- Quill JS -->
    <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
    <script>
      const quill = new Quill("#editor", {
        theme: "snow",
        placeholder: "Décris l’offre...",
        modules: {
          toolbar: [
            ["bold", "italic", "underline"],
            [{ list: "ordered" }, { list: "bullet" }],
            ["blockquote", "clean"],
          ],
        },
      });

      document.querySelector("form").addEventListener("submit", function () {
        document.querySelector("#description").value = quill.root.innerHTML;
      });
    </script>
  </body>
</html>
