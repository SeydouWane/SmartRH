<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <title>Créer un appel à candidature</title>

    <!-- Quill CSS -->
    <link
      href="https://cdn.quilljs.com/1.3.6/quill.snow.css"
      rel="stylesheet"
    />

    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 30px;
      }

      h2 {
        color: #333;
      }

      .form-section {
        margin-bottom: 20px;
      }

      label {
        display: block;
        font-weight: bold;
        margin-bottom: 5px;
      }

      input[type="text"],
      input[type="date"],
      .ql-editor {
        width: 100%;
        padding: 8px;
        margin-bottom: 10px;
        font-size: 14px;
      }

      .btn {
        padding: 10px 15px;
        background-color: green;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
      }

      .btn:hover {
        background-color: darkgreen;
      }

      #editor {
        height: 200px;
        background-color: white;
      }
    </style>
  </head>

  <body>
    <h2>➕ Ajouter un appel à candidature</h2>

    <form method="POST">
      <!-- Titre -->
      <div class="form-section">
        <label for="titre">Nom de l’appel</label>
        <input
          type="text"
          name="titre"
          id="titre"
          placeholder="Ex: Data Analyst"
          required
        />
      </div>

      <!-- Date de début -->
      <div class="form-section">
        <label for="date_debut">Date de début</label>
        <input type="date" name="date_debut" id="date_debut" required />
      </div>

      <!-- Date de fin -->
      <div class="form-section">
        <label for="date_fin">Date de fin</label>
        <input type="date" name="date_fin" id="date_fin" required />
      </div>

      <!-- Description avec éditeur Quill -->
      <div class="form-section">
        <label for="description">Description</label>
        <div id="editor" placeholder="Décris l’offre..."></div>
        <input type="hidden" name="description" id="description" />
      </div>

      <!-- Critères -->
      <div class="form-section">
        <label for="criteres"
          >Critères attendus (séparés par des virgules)</label
        >
        <input
          type="text"
          name="criteres"
          id="criteres"
          placeholder="Ex: Python, Power BI, SQL"
          required
        />
      </div>

      <!-- Bouton de soumission -->
      <button type="submit" class="btn">GÉNÉRER LE LIEN DU FORMULAIRE</button>
    </form>

    <!-- Lien retour -->
    <p>
      <a href="{{ url_for('appel.appel_home') }}"
        >⬅ Retour au tableau de bord</a
      >
    </p>

    <!-- Messages flash -->
    {% with messages = get_flashed_messages(with_categories=true) %} {% if
    messages %}
    <ul>
      {% for category, message in messages %}
      <li style="color: green"><strong>{{ message }}</strong></li>
      {% endfor %}
    </ul>
    {% endif %} {% endwith %}

    <!-- Quill JS -->
    <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
    <script>
      const quill = new Quill("#editor", {
        theme: "snow",
        placeholder: "Décris l’offre...",
        modules: {
          toolbar: [
            ["bold", "italic", "underline"],
            [{ list: "ordered" }, { list: "bullet" }],
            ["blockquote", "clean"],
          ],
        },
      });

      // Copie le contenu HTML de Quill dans le champ caché à la soumission
      document.querySelector("form").addEventListener("submit", function () {
        document.querySelector("#description").value = quill.root.innerHTML;
      });
    </script>
  </body>
</html>
